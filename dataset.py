from langchain.prompts import ChatPromptTemplate, FewShotChatMessagePromptTemplate

# Chat prompt template for few-shot learning
examples =  [
    {
    "input": "Compare the billing cycles 1 with 2 and provide reasons for the higher cost in cycle 1.\ndata_str1 = {\"IntervalStartDate\":\"2021-12-22\",\"IntervalEndDate\":\"2022-01-24\",\"consumption\":599,\"cost\":48,\"num_days\":34,\"num_holidays\":3, \"num_vacation\": 0,\"holidays\":[], \"temperature\":35,'tierDetails':'unavailable', 'touDetails':'unavailable', \"itemizationDetailsList\":{\"airConditioning\":[0,0],\"alwaysOn\":[111,9],\"electricVehicle\":[0,0],\"entertainment\":[64,5],\"lighting\":[57,5],\"otherGeneralUsage\":[367,29],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndata_str2 = {\"IntervalStartDate\":\"2022-01-25\",\"IntervalEndDate\":\"2022-02-22\",\"consumption\":452,\"cost\":36,\"num_days\":29,\"num_holidays\":1,\"num_vacation\": 3,\"holidays\":[], \"temperature\":33,'tierDetails': 'unavailable', 'touDetails': 'unavailable', \"itemizationDetailsList\":{\"airConditioning\":[0,0],\"alwaysOn\":[49,4],\"electricVehicle\":[0,0],\"entertainment\":[57,5],\"lighting\":[51,4],\"otherGeneralUsage\":[295,23],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndiff  = {'consumption': -147, 'cost': -12, 'num_days': -5, 'num_holidays': -2,'num_vacation':3,'temperature': -2, 'electricity_rates': 'same', 'itemizationDetailsList': {'airConditioning': [0, 0], 'alwaysOn': [-62, -5], 'electricVehicle': [0, 0], 'entertainment': [-7, 0], 'lighting': [-6, -1], 'otherGeneralUsage': [-72, -6], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "Possible reasons for the higher cost in Cycle 1 are:\n\n1. Cycle 2 is shorter by 5 days compared to Cycle 1. Additionally, Cycle 1 included 3 holidays, while Cycle 2 had only 1 holiday. These factors might have contributed to a $5 decrease in the usage of always-on appliances.\n2. The usage of lighting appliances decreased by 6 kWh in the second billing cycle, leading to a cost reduction of $1.\n3. There was a $6 decrease in other general usage or fees.\n4. Cycle 2 had three vacation days which might have caused a reduction in the overall usage."
    },
    {
    "input": "Give insights after comparing the billing cycles 1 and 2.\ndata_str1 = {\"IntervalStartDate\":\"2022-04-23\",\"IntervalEndDate\":\"2022-05-21\",\"consumption\":640,\"cost\":56,\"num_days\":29,\"num_holidays\":0,'num_vacation':3,\"holidays\":[],\"temperature\":67,'tierDetails':'unavailable','touDetails':'unavailable',\"itemizationDetailsList\":{\"airConditioning\":[165,15],\"alwaysOn\":[199,17],\"electricVehicle\":[0,0],\"entertainment\":[35,3],\"lighting\":[30,3],\"otherGeneralUsage\":[211,18],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndata_str2 = {\"IntervalStartDate\":\"2022-05-22\",\"IntervalEndDate\":\"2022-06-22\",\"consumption\":1055,\"cost\":120,\"num_days\":32,\"num_holidays\":2,'num_vacation':0,\"holidays\":[\"Memorial Day\",\"Juneteenth National Independence Day\"],\"temperature\":75,'tierDetails':'unavailable', 'touDetails':{'on-peak': [278, 42], 'mid-peak': [534, 60], 'off-peak': [243, 18]},\"itemizationDetailsList\":{\"airConditioning\":[522,59],\"alwaysOn\":[219,25],\"electricVehicle\":[0,0],\"entertainment\":[41,4],\"lighting\":[16,2],\"otherGeneralUsage\":[257,30],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndiff = \n {'consumption': 415, 'cost': 64, 'num_days': 3, 'num_holidays': 2, 'num_vacation': -3, 'temperature': 8,  'electricity_rates': 'higher in cycle2 and lower in cycle1', 'itemizationDetailsList': {'airConditioning': [357, 44], 'alwaysOn': [20, 8], 'electricVehicle': [0, 0], 'entertainment': [6, 1], 'lighting': [-14, -1], 'otherGeneralUsage': [46, 12], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "Thought: Here, rate plans were not available for the first cycle but for the second cycle, tou details were available. Also, the usage cost was more in the second cycle. This means that there was more on peak consumption in the second cycle. Responses: Possible reasons for the higher cost in Cycle 2 are:\n\n1. Increased air conditioning usage in Cycle 2 contributed an additional $44, which is influenced by the increase in average temperature by 8°F during this period.\n2. A $12 increase can be attributed to other general and miscellaneous usage.\n3. The second cycle, which was three days longer and included two holidays (Memorial Day and Juneteenth), likely contributed to higher costs, especially for always-on appliances. In contrast, Cycle 1 had three vacation days, resulting in lower energy consumption, as indicated by an $8 increase in always-on appliance costs in Cycle 2.\n4. Second cycle had more consumption during on-peak hours which might have also led to an increase in overall usage costs.\n5. Second cycle had a slight increase in consumption in entertainment raising the costs by $1, however this was compensated by reduced cost in lighting by $1."
    },
    {
    "input": "Provide reasons for the significant usage cost difference between cycle 1 and cycle 2.\ndata_str1 = {'IntervalStartDate': '2021-06-24', 'IntervalEndDate': '2021-07-22', 'consumption': 1105, 'cost': 131, 'num_days': 29, 'num_holidays': 1, 'num_vacation': 0, 'holidays': ['Independence Day'], 'temperature': 77, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [562, 66], 'alwaysOn': [96, 12], 'electricVehicle': [0, 0], 'entertainment': [40, 5], 'lighting': [35, 4], 'otherGeneralUsage': [372, 44], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndata_str2 = {'IntervalStartDate': '2021-09-22', 'IntervalEndDate': '2021-10-20', 'consumption': 701, 'cost': 65, 'num_days': 29, 'num_holidays': 1, 'num_vacation': 0, 'holidays': ['Columbus Day'], 'temperature': 67, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [350, 32], 'alwaysOn': [77, 7], 'electricVehicle': [0, 0], 'entertainment': [40, 4], 'lighting': [37, 3], 'otherGeneralUsage': [197, 19], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndiff = {'consumption': -404, 'cost': -66, 'num_days': 0, 'num_holidays': 0, 'num_vacation': 0, 'temperature': -10, 'electricity_rates': 'same', 'itemizationDetailsList': {'airConditioning': [-212, -34], 'alwaysOn': [-19, -5], 'electricVehicle': [0, 0], 'entertainment': [0, -1], 'lighting': [2, -1], 'otherGeneralUsage': [-175, -25], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "Possible reasons for the significant cost difference between the two billing cycles are:\n\n1. Air conditioning costs decreased by $34 in the later billing cycle due to a 10-degree drop in average temperature, leading to reduced air conditioning usage.\n2. 'AlwaysOn' category costs were reduced by $5 in the second cycle, reflecting decreased usage of devices like standby electronics.\n3. The cost associated with lighting and entertainment appliances decreased by $2 in the later cycle, despite a slight increase in usage, indicating efficiency improvements.\n4. There was a $25 decrease attributed to miscellaneous usage and other general fees."
    },
    {
    "input": "Compare billing cycle 1 with billing cycle 2, and provide reasons for the higher cost in cycle 1, despite it having a shorter billing period than cycle 2.\ndata_str1 = {'IntervalStartDate': '2021-08-23', 'IntervaleEndDate': '2021-09-21', 'consumption': 1006, 'cost': 119, 'num_days': 30, 'num_holidays': 1, 'num_vacation': 1, 'holidays': ['Labor Day'], 'temperature': 76, 'tierDetails': 'unavailable', 'touDetails': {'on-peak': [628, 56], 'mid-peak': [321, 38], 'off-peak': [57, 25]}, 'itemizationDetailsList': {'airConditioning': [508, 60], 'alwaysOn': [98, 12], 'electricVehicle': [0, 0], 'entertainment': [43, 5], 'lighting': [42, 5], 'other': [315, 37], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndata_str2 = {'IntervalStartDate': '2021-10-21', 'IntervalEndDate': '2021-11-21', 'consumption': 543, 'cost': 44, 'num_days': 32, 'num_holidays': 1, 'num_vacation': 4, 'holidays': ['Veterans Day'], 'temperature': 49, 'tierDetails': 'unavailable', 'touDetails': {'on-peak': [194, 12], 'mid-peak': [167, 14], 'off-peak': [182, 18]}, 'itemizationDetailsList': {'airConditioning': [163, 13], 'alwaysOn': [87, 7], 'electricVehicle': [0, 0], 'entertainment': [45, 4], 'lighting': [45, 4], 'other': [203, 16], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndiff = {'consumption': -463, 'cost': -75, 'num_days': 2, 'num_holidays': 0, 'num_vacation': 3, 'temperature': -27, 'electricity_rates': 'lower in cycle2 and higher in cycle1', 'itemizationDetailsList': {'airConditioning': [-345, -47], 'alwaysOn': [-11, -5], 'electricVehicle': [0, 0], 'entertainment': [2, -1], 'lighting': [3, -1], 'other': [-112, -21], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "Thought: Electricity rates are higher in cycle 1 than cycle 2 probably due to more on-peak usage in the first cycle. Also, the user was on vacation for 4 days in cycle 2 compared to only 1 in cycle 2 which might have caused reduced consumption during those days. Response: Possible reasons for the significant cost difference between the two billing cycles are:\n\n1. Cycle 2 experienced significantly lower temperatures (49°F compared to 76°F in cycle 1), leading to increased cooling needs. As a result, air conditioning costs were $47 higher in cycle 1. Although both billing cycles included one holiday, the slightly longer duration of cycle 2 (32 days versus 30 days in cycle 1) did not sufficiently offset the increased air conditioning expenses.\n2. The second cycle incurred $5 less on always-on devices likely due to reduced overall consumption partly ascribed to the 3 extra vacation days.\n3. There was a $21 decrease associated with other general usage indicating lower consumption of miscellaneous items.\n4. The cost for entertainment and lighting appliances collectively dropped by $2 despite a minuscule increase in usage, suggesting possible efficiency improvements owing to more off-peak usage in the second cycle.\n5. Both cycles having time-of-use plans, Cycle 1 witnessed higher electricity costs compared to Cycle 2 predominantly due to more on-peak hour usage."
    },
    {
    "input": "Why was the total cost in cycle 1 greater than in cycle 2?\nCycle 1  = {\"IntervalStartDate\":\"2022-02-23\",\"IntervalEndDate\":\"2022-03-23\",\"consumption\":431,\"cost\":37,\"num_days\":29,\"num_holidays\":0,\"num_vacation\":0,\"holidays\":[],\"temperature\":45,\"tierDetails\": \"unavailable\",\"touDetails\": \"unavailable\",\"itemizationDetailsList\":{\"airConditioning\":[57,5],\"alwaysOn\":[133,12],\"electricVehicle\":[0,0],\"entertainment\":[42,4],\"lighting\":[39,3],\"otherGeneralUsage\":[140,13],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\nCycle 2 = {\"IntervalStartDate\":\"2022-03-24\",\"IntervalEndDate\":\"2022-04-22\",\"consumption\":487,\"cost\":43,\"num_days\":30,\"num_holidays\":0,\"num_vacation\":0,\"holidays\":[],\"temperature\":51,\"tierDetails\": \"unavailable\",\"touDetails\": \"unavailable\",\"itemizationDetailsList\":{\"airConditioning\":[190,17],\"alwaysOn\":[140,12],\"electricVehicle\":[0,0],\"entertainment\":[25,2],\"lighting\":[27,3],\"otherGeneralUsage\":[105,9],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\ndiff= {'consumption': 56, 'cost': 6, 'num_days': 1, 'num_holidays': 0, 'num_vacation': 0, 'temperature': 6, 'electricity_rates': 'same', 'itemizationDetailsList': {'airConditioning': [133, 12], 'alwaysOn': [7, 0], 'electricVehicle': [0, 0], 'entertainment': [-17, -2], 'lighting': [-12, 0],\"otherGeneralUsage\":[-35,-4], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "It appears there is a misunderstanding. In fact, the total cost in cycle 1 was $6 less than in cycle 2. Possible reasons for this difference include:\n\n1. The cost for \"airConditioning\" increased by $12 in cycle 2, possibly due to the 6-degree increase in temperature, leading to higher usage in warmer weather.\n\n2. The \"entertainment\" category saw a $2 decrease in cycle 2, reflecting less usage of leisure electronics.\n\n3. Cycle 2 was one day longer than cycle 1, which might have partially contributed to the increase in total usage costs. This extended duration could have resulted in a $4 decrease in miscellaneous usage costs for cycle 2.\n\n4. Overall consistency in always-on and lighting appliances usage and associated costs between the two cycles suggests that price differences are influenced by variations in appliance use strategies."
    },
    {
    "input": "Compare the following two billing cycles.\ndata_str1= {'IntervalStartDate': '2021-03-23', 'IntervalEndDate': '2021-04-22', 'consumption': 1711, 'cost': 310, 'num_days': 31, 'num_holidays': 0, 'num_vacation': 4, 'holidays': [], 'temperature': 50, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': 'unavailable'}\ndata_str2= {'IntervalStartDate': '2021-04-23', 'IntervalEndDate': '2021-05-20', 'consumption': 2471, 'cost': 431, 'num_days': 28, 'num_holidays': 0, 'num_vacation': 0, 'holidays': [], 'temperature': 58, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': 'unavailable'}\ndiff= {'consumption': 760, 'cost': 121, 'num_days': -3, 'num_holidays': 0, 'num_vacation': -4, 'temperature': 8, 'electricity_rates': 'same', 'itemizationDetailsList': 'unavailable in both cycles'}\nLocation = {'city': 'WOODBURY', 'state': 'NY', 'country': 'US', 'zip': '11797'}\n",
    "output": "Thought: Here, itemization details are unavailable for both cycles so you cannot make any assumption about the categories. Instead you can use the other data provided to make the reasons. Responses: Possible reasons for the higher cost in Cycle 2 are:\n\n1. The total consumption in Cycle 2 increased by 760 kWh compared to Cycle 1, contributing significantly to an additional $121 in costs, even though electricity rates remained unchanged.\n2. Warmer average temperature (58°F compared to 50°F) in Cycle 2 led to increased cooling needs, likely driving up energy consumption.\n3. There were no vacation days in Cycle 2, while Cycle 1 had 4 vacation days, resulting in overall higher energy usage when the premise was fully occupied.\n4. Despite Cycle 2 being 3 days shorter, the significant increase in energy usage underscores heightened appliance usage and cooling demands during the billing period."
    },
    {
    "input": "Why is the usage cost more in cycle 2 than cycle 1?\ndata_str1= {'IntervalStartDate': '2021-07-23', 'IntervalEndDate': '2021-08-23', 'consumption': 4849, 'cost': 1085, 'num_days': 32, 'num_holidays': 0, 'num_vacation': 0, 'holidays': [], 'temperature': 74, 'tierDetails': \"{'0': [1317, 296], '1': [1601, 359], '2': [1931, 430]}\", 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [2973, 665], 'alwaysOn': [787, 176], 'electricVehicle': [0, 0], 'entertainment': [84, 19], 'lighting': [43, 10], 'otherGeneralUsage': [590, 132], 'pool': [372, 83], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndata_str2= {'IntervalStartDate': '2021-08-24', 'IntervalEndDate': '2021-09-21', 'consumption': 4618, 'cost': 1059, 'num_days': 29, 'num_holidays': 0, 'num_vacation': 3, 'holidays': [], 'temperature': 72, 'tierDetails': \"{'0': [1338, 311], '1': [1903, 436], '2': [1377, 312]}\", 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [2775, 637], 'alwaysOn': [713, 164], 'electricVehicle': [0, 0], 'entertainment': [96, 22], 'lighting': [39, 9], 'otherGeneralUsage': [516, 117], 'pool': [479, 110], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndiff= {'consumption': -231, 'cost': -26, 'num_days': -3, 'num_holidays': 0, 'num_vacation': 3, 'temperature': -2, 'electricity_rates': 'same', 'itemizationDetailsList': {'airConditioning': [-198, -28], 'alwaysOn': [-74, -12], 'electricVehicle': [0, 0], 'entertainment': [12, 3], 'lighting': [-4, -1], 'pool': [107, 27], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\nLocation = {'city': 'WOODBURY', 'state': 'NY', 'country': 'US', 'zip': '11797'}\n",
    "output": "Thought: Here, the user asked a factually incorrect question, here the usage cost was less in cycle 2 than cycle 1. Here, there were 3 vacation days in the second cycle and billing cycle was also 3 days shorter. This led to decreased cost in the second cycle. Responses: It seems there is a misunderstanding. In fact, the total cost in Cycle 2 was $26 less than in Cycle 1. Possible reasons for this cost difference include:\n\n1. The average temperature during Cycle 1 was 74°F, higher than the 72°F in Cycle 2, which led to a $28 reduction in air conditioning costs in Cycle 2 due to lower cooling needs.\n2. There was a significant increase in the usage of the pool pump in Cycle 2, resulting in a $27 increase in associated costs.\n3. In Cycle 1, costs for always-on and general appliances were $27 higher than in Cycle 2, due to reduced usage of 74 kWh in Cycle 2.\n4. Entertainment device costs were $3 higher in Cycle 2 due to increased use of leisure electronics.\n5. Lighting costs decreased by $1 in Cycle 2 due to reduced usage.\n6. Cycle 2 had 3 fewer days and included 3 vacation days when the house was unoccupied, which helped balance the costs, despite the notable increase in pool usage."
    },
    {
    "input": "Provide reasons for the cost difference in the following billing cycles.\ndata_str1 = {'IntervalStartDate': '2021-12-21', 'IntervalEndDate': '2022-01-23', 'consumption': 3331, 'cost': 587, 'num_days': 34, 'num_holidays': 3, 'num_vacation': 1, 'holidays': ['Christmas Day', \"New Year's Day\", 'Martin Luther King Jr. Day'], 'temperature': 33, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [0, 0], 'alwaysOn': [871, 153], 'electricVehicle': [0, 0], 'entertainment': [130, 23], 'lighting': [96, 17], 'otherGeneralUsage': [607, 107], 'pool': [0, 0], 'spaceHeating': [1627, 287], 'waterHeating': [0, 0]}}\ndata_str2 = {'IntervalStartDate': '2022-04-22', 'IntervalEndDate': '2022-05-19', 'consumption': 2314, 'cost': 456, 'num_days': 28, 'num_holidays': 0, 'num_vacation': 5, 'holidays': [], 'temperature': 56, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [0, 0], 'alwaysOn': [717, 141], 'electricVehicle': [0, 0], 'entertainment': [109, 21], 'lighting': [54, 11], 'otherGeneralUsage': [486, 96], 'pool': [511, 101], 'spaceHeating': [437, 86], 'waterHeating': [0, 0]}}\ndiff = {'consumption': -1017, 'cost': -131, 'num_days': -6, 'num_holidays': -3, 'num_vacation': 4, 'temperature': 23, 'electricity_rates': 'same', 'itemizationDetailsList': {'airConditioning': [0, 0], 'alwaysOn': [-154, -12], 'electricVehicle': [0, 0], 'entertainment': [-21, -2], 'lighting': [-42, -6], 'otherGeneralUsage': [-121, -11], 'pool': [511, 101], 'spaceHeating': [-1190, -201], 'waterHeating': [0, 0]}}\nLocation = {'city': 'WOODBURY', 'state': 'NY', 'country': 'US', 'zip': '11797'}\n",
    "output": "Thought: Cycle 2 had 5 vacation days compared to only 1 vacation day in Cycle 1, resulting in reduced consumption. Additionally, Cycle 1 had 6 extra days compared to Cycle 2, and three holidays (Christmas Day, New Year's Day, and Martin Luther King Jr. Day) which caused increased consumption during those days. Responses: The differences in costs between the two billing cycles can be attributed to several factors:\n\n1. In the second billing cycle, there was a significant decrease of $201 in space heating costs. This reduction is likely due to the warmer weather, as the average temperature rose to 56 degrees, resulting in lower heating needs compared to the first cycle.\n\n2. The cost associated with the pool pump increased substantially by $101 in the second cycle. This indicates higher usage of the pool pump during this period.\n\n3. The first billing cycle included three holidays (Christmas Day, New Year's Day, and Martin Luther King Jr. Day) and was six days longer than the second cycle. Additionally, the first cycle had only 1 vacation day compared to 5 vacation days in the second cycle. These factors likely reduced the 'alwaysOn' consumption in the second cycle, contributing to a $12 decrease in usage.\n\n4. There was an additional $6 cost in lighting appliances during the first cycle. This can be attributed to longer winter nights in December and January, which increased the need for lighting.\n\n5. The second cycle saw a reduction of $2 in costs for entertainment devices and appliances. This decrease is likely due to increased leisure activities during the warmer weather, which reduced the usage of these devices.\n\n6. A decrease of $11 in the second cycle can be attributed to other general usage factors."
    },
    {
    "input": "Provide reasons for the cost difference in the following billing cycles.\n\nCycle 1 = {{\"IntervalStartDate\": \"2022-08-11\", \"IntervalEndDate\": \"2022-09-09\", \"consumption\": 1090, \"cost\": 112, \"num_days\": 30, \"num_holidays\": 1, \"num_vacation\": 0, \"holidays\": [\"Labor Day\"], \"temperature\": 75, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {{\"airConditioning\": [587, 61], \"alwaysOn\": [197, 20], \"electricVehicle\": [0, 0], \"entertainment\": [56, 6], \"lighting\": [8, 1], \"pool\": [70, 7], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [172, 17]}}}}\n\nCycle 2 = {{\"IntervalStartDate\": \"2022-09-10\", \"IntervalEndDate\": \"2022-10-10\", \"consumption\": 832, \"cost\": 87, \"num_days\": 31, \"num_holidays\": 0, \"num_vacation\": 2, \"holidays\": [], \"temperature\": 65, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {{\"airConditioning\": [199, 21], \"alwaysOn\": [224, 23], \"electricVehicle\": [0, 0], \"entertainment\": [73, 8], \"lighting\": [16, 2], \"pool\": [91, 9], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [229, 24]}}}}\n\ndiff = {{\"consumption\": -258, \"cost\": -25, \"num_days\": 1, \"num_holidays\": -1, \"num_vacation\": 2, \"temperature\": -10, \"electricity_rates\": \"same\", \"itemizationDetailsList\": {{\"airConditioning\": [-388, -40], \"alwaysOn\": [27, 3], \"electricVehicle\": [0, 0], \"entertainment\": [17, 2], \"lighting\": [8, 1], \"otherGeneralUsage\": [57, 7], \"pool\": [21, 2], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0]}}}}\n\nLocation = {\"city\": \"PHOENIX\", \"state\": \"OR\", \"country\": \"US\", \"zip\": \"97535\"}\n",
    "output": "Thought: Here, the 2 vacation days in the second cycle decreased usage and 1 holiday in the first cycle increased usage. Responses: Possible reasons for the cost difference between the two billing cycles are:\n\n1. The air conditioning usage in Cycle 1 was significantly higher, resulting in an additional $40 in costs. This is likely due to the higher temperature of 75°F in Cycle 1 compared to 65°F in Cycle 2 showing a transition from the peak summer heat to more moderate early fall conditions.\n\n2. The always-on appliances contributed $3 more in costs in Cycle 2, reflecting an increased consumption of devices that remain continuously plugged in.\n\n3. Other general usage saw a $7 increase in Cycle 2, which might be due to the additional day and higher overall usage of miscellaneous appliances.\n\n4. During Cycle 1, there was a holiday (Labor Day) that likely increased overall consumption, whereas Cycle 2 had no holidays but included 2 vacation days, leading to reduced usage and lowering the overall costs.\n\n5. Entertainment costs increased by $2 in Cycle 2, and lighting and pool expenses also raised by $1 and $2 respectively, contributing to the overall cost differences between the two cycles."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2023-10-20\", \"IntervalEndDate\": \"2023-11-19\", \"consumption\": 634, \"cost\": 126, \"num_days\": 31, \"num_holidays\": 2, \"num_vacation\": 1, \"holidays\": [\"Election Day\", \"Veterans Day\"], \"temperature\": 50, \"touDetails\": {\"on-peak\": [65, 20], \"mid-peak\": [404, 85], \"off-peak\": [165, 21]}, \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [0, 0], \"alwaysOn\": [249, 50], \"electricVehicle\": [0, 0], \"entertainment\": [32, 6], \"lighting\": [11, 2], \"pool\": [0, 0], \"spaceHeating\": [35, 7], \"waterHeating\": [62, 12], \"otherGeneralUsage\": [245, 49]}}\n\nCycle 2 = {\"IntervalStartDate\": \"2023-11-20\", \"IntervalEndDate\": \"2023-12-18\", \"consumption\": 809, \"cost\": 163, \"num_days\": 29, \"num_holidays\": 0, \"num_vacation\": 4, \"holidays\": [], \"temperature\": 42, \"touDetails\": {\"on-peak\": [101, 34], \"mid-peak\": [474, 99], \"off-peak\": [234, 30]}, \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [0, 0], \"alwaysOn\": [135, 27], \"electricVehicle\": [0, 0], \"entertainment\": [28, 6], \"lighting\": [20, 4], \"pool\": [0, 0], \"spaceHeating\": [353, 71], \"waterHeating\": [32, 6], \"otherGeneralUsage\": [241, 49]}}\n\ndiff = {\"consumption\": 175, \"cost\": 37, \"num_days\": -2, \"num_holidays\": -2, \"num_vacation\": 3, \"temperature\": -8, \"electricity_rates\": \"same\", \"itemizationDetailsList\": {\"airConditioning\": [0, 0], \"alwaysOn\": [-114, -23], \"electricVehicle\": [0, 0], \"entertainment\": [-4, 0], \"lighting\": [9, 2], \"otherGeneralUsage\": [-4, 0], \"pool\": [0, 0], \"spaceHeating\": [318, 64], \"waterHeating\": [-30, -6]}}\n\nLocation = {\"city\":\"E HAMPTON\", \"state\":\"NY\", \"country\":\"US\", \"zip\":\"11937\"}\n",
    "output": "Possible reasons for the higher cost in Cycle 2 are:\n\n1. The colder average temperature of 42°F in Cycle 2, compared to 50°F in Cycle 1, led to an additional $64 in space heating costs. This is due to the colder weather in East Hampton, New York, during late November and early December.\n\n2. The always-on usage decreased by $23 in Cycle 2. This reduction was because Cycle 2 had 4 vacation days compared to only 1 in Cycle 1, leading to less consumption. Additionally, Cycle 2 was 2 days shorter and had no holidays, unlike Cycle 1, which had Election Day and Veterans Day, causing increased consumption during those holidays.\n\n3. Lighting costs increased by $2 in Cycle 2, reflecting higher usage due to the longer nights typical of the winter period.\n\n4. Water heating costs dropped by $6 in Cycle 2, indicating either less usage or more efficient utilization of water heating during this period.\n\n5. Despite the decrease in always-on and water heating costs, the overall expenses still increased. This was mainly due to the substantial rise in space heating costs, which outweighed the savings from other areas."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2023-08-11\", \"IntervalEndDate\": \"2023-09-11\", \"consumption\": 1162, \"cost\": 151, \"num_days\": 32, \"num_holidays\": 1, \"num_vacation\": 0, \"holidays\": [\"Labor Day\"], \"temperature\": 72, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [505, 65], \"alwaysOn\": [280, 36], \"electricVehicle\": [0, 0], \"entertainment\": [70, 9], \"lighting\": [9, 1], \"pool\": [76, 10], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [222, 30]}}\n\nCycle 2 = {\"IntervalStartDate\": \"2023-09-12\", \"IntervalEndDate\": \"2023-10-10\", \"consumption\": 743, \"cost\": 101, \"num_days\": 29, \"num_holidays\": 0, \"num_vacation\": 2, \"holidays\": [], \"temperature\": 62, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [90, 12], \"alwaysOn\": [216, 29], \"electricVehicle\": [0, 0], \"entertainment\": [79, 11], \"lighting\": [15, 2], \"pool\": [90, 12], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [253, 35]}}\n\ndiff = {\"consumption\": -419, \"cost\": -50, \"num_days\": -3, \"num_holidays\": -1, \"num_vacation\": 2, \"temperature\": -10, \"electricity_rates\": \"same\", \"itemizationDetailsList\": {\"airConditioning\": [-415, -53], \"alwaysOn\": [-64, -7], \"electricVehicle\": [0, 0], \"entertainment\": [9, 2], \"lighting\": [6, 1], \"otherGeneralUsage\": [31, 5], \"pool\": [14, 2], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0]}}\n\nLocation = {\"city\": \"PHOENIX\", \"state\": \"OR\", \"country\": \"US\", \"zip\": \"97535\"}\n",
    "output": "Possible reasons for the cost difference between the two billing cycles are:\n\n1. The cost of air conditioning in Cycle 1 was significantly higher, being $53 more than in Cycle 2. This was due to the hotter weather in Cycle 1, with an average temperature of 72°F compared to 62°F in Cycle 2.\n\n2. In Cycle 1, \"always on\" devices incurred $7 more in costs than in Cycle 2. This could be attributed to the additional three days in the billing cycle and the Labor Day holiday, which likely increased the overall usage of continuously plugged-in devices.\n\n3. Entertainment, pool, and lighting appliances usage saw increases in Cycle 2, leading to an additional $5 in total for these categories.\n\n4. General usage appliances saw a $5 increase in cost in Cycle 2, indicating higher usage of miscellaneous items despite the shorter billing cycle.\n\n5. Cycle 2 had two vacation days, contributing to reduced overall consumption and resulting in lower overall costs."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2021-05-29\", \"IntervalEndDate\": \"2021-06-29\", \"consumption\": 1386, \"cost\": 171, \"num_days\": 32, \"num_holidays\": 2, \"num_vacation\": 0, \"holidays\": [\"Memorial Day\", \"Juneteenth National Independence Day\"], \"temperature\": 94, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [766, 94], \"alwaysOn\": [270, 33], \"electricVehicle\": [0, 0], \"entertainment\": [19, 2], \"lighting\": [41, 5], \"pool\": [161, 20], \"spaceHeating\": [0, 0], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [129, 17]}}\n\nCycle 2 = {\"IntervalStartDate\": \"2021-07-30\", \"IntervalEndDate\": \"2021-08-30\", \"consumption\": 2581, \"cost\": 296, \"num_days\": 32, \"num_holidays\": 0, \"num_vacation\": 0, \"holidays\": [], \"temperature\": 94, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": \"unavailable\"}\n\ndiff = {\"consumption\": 1195, \"cost\": 125, \"num_days\": 0, \"num_holidays\": -2, \"num_vacation\": 0, \"temperature\": 0, \"electricity_rates\": \"same\", \"itemizationDetailsList\": \"unavailable in cycle2\"}\n\nLocation = {\"city\": \"LAS VEGAS\", \"state\": \"NV\", \"country\": \"US\", \"zip\": \"89120\"}\n",
    "output": "Thought: Since the itemization details are not available for cycle 2, reasons provided should not focus on any particular appliance category and rather should be on other factors. Unavailability of itemization data should not be mentioned. Response: Possible reasons for the cost difference between the two billing cycles are:\n\n1. The second cycle had a significantly higher consumption of 1,195 kWh than the first cycle, which translated to an additional $125 in costs. Both cycles had the same rates, making the increased consumption the primary factor for the cost difference.\n\n2. There were two holidays (Memorial Day and Juneteenth National Independence Day) in the first cycle, likely leading to increased usage during those days. This might have partially offset the higher costs seen in the second cycle.\n\n3. Air conditioning contributed $94 to the cost in the first cycle. Given the constant temperature of 94°F in both cycles, it is likely that air conditioning would be a significant contributor to the costs in Cycle 2 as well.\n\n4. The overall cost increase can thus be attributed to increased consumption in all categories."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2015-12-01\", \"IntervalEndDate\": \"2015-12-30\", \"consumption\": 1199, \"cost\": 163, \"num_days\": 30, \"num_holidays\": 0, \"num_vacation\": 0, \"holidays\": [], \"temperature\": 46, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": \"unavailable\"}\n\nCycle 2 = {\"IntervalStartDate\": \"2015-12-31\", \"IntervalEndDate\": \"2016-01-29\", \"consumption\": 1186, \"cost\": 154, \"num_days\": 30, \"num_holidays\": 2, \"num_vacation\": 0, \"holidays\": [\"New Year's Day\", \"Martin Luther King Jr. Day\"], \"temperature\": 47, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [0, 0], \"alwaysOn\": [180, 24], \"electricVehicle\": [0, 0], \"entertainment\": [99, 13], \"lighting\": [72, 9], \"pool\": [0, 0], \"spaceHeating\": [582, 76], \"waterHeating\": [0, 0], \"otherGeneralUsage\": [253, 32]}}\n\ndiff = {\"consumption\": -13, \"cost\": -9, \"num_days\": 0, \"num_holidays\": 2, \"num_vacation\": 0, \"temperature\": 1, \"electricity_rates\": \"same\", \"itemizationDetailsList\": \"unavailable in cycle1\"}\n\nLocation = {\"city\": \"LAS VEGAS\", \"state\": \"NV\", \"country\": \"US\", \"zip\": \"89120\"}\n",
    "output": "Thought: Since the itemization details are not available for cycle 1, reasons provided should not focus on any particular appliance category and rather should be on other factors. Response: Possible reasons for the cost difference between the two billing cycles are:\n\n1. The second billing cycle included two holidays (New Year's Day and Martin Luther King Jr. Day) while the first cycle had no holidays. These holidays likely led to increased energy consumption in areas like space heating and general usage but still resulted in a lower overall cost.\n\n2. Despite the slight increase in temperature (47°F compared to 46°F), the cost for space heating in Cycle 2 was $76, indicating significant heating requirements due to colder weather in Las Vegas during that period.\n\n3. The slight reduction in air conditioning and stable baseline for electric vehicle costs had no significant impact on the overall difference, reinforcing the influence of increased holiday and seasonal activities."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2020-09-10\", \"IntervalEndDate\": \"2020-10-08\", \"consumption\": 729, \"cost\": 79, \"num_days\": 29, \"num_holidays\": 0, \"num_vacation\": 0, \"holidays\": [], \"temperature\": 64, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": \"unavailable\"}\n\nCycle 2 = {\"IntervalStartDate\": \"2020-12-11\", \"IntervalEndDate\": \"2021-01-12\", \"consumption\": 725, \"cost\": 78, \"num_days\": 33, \"num_holidays\": 2, \"num_vacation\": 0, \"holidays\": [\"Christmas Day\", \"New Year's Day\"], \"temperature\": 40, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": {\"airConditioning\": [0, 0], \"alwaysOn\": [224, 24], \"electricVehicle\": [0, 0], \"entertainment\": [50, 6], \"lighting\": [11, 1], \"pool\": [0, 0], \"spaceHeating\": [0, 0], \"waterHeating\": [263, 28], \"otherGeneralUsage\": [177, 19]}}\n\ndiff = {\"consumption\": -4, \"cost\": -1, \"num_days\": 4, \"num_holidays\": 2, \"num_vacation\": 0, \"temperature\": -24, \"electricity_rates\": \"same\", \"itemizationDetailsList\": \"unavailable in cycle1\"}\n\nLocation = {\"city\": \"PHOENIX\", \"state\": \"OR\", \"country\": \"US\", \"zip\": \"97535\"}\n",
    "output": "Thought: Since the itemization details are not available for cycle 1, reasons provided should not focus on any particular appliance category and rather should be on other factors. Possible reasons for the cost difference between the two billing cycles are:\n\n1. The slight difference in consumption (729 kWh in Cycle 1 vs. 725 kWh in Cycle 2) and cost ($79 in Cycle 1 vs. $78 in Cycle 2) indicates that the two cycles had nearly identical energy usage and costs. The difference in consumption and cost is minimal, primarily affected by other factors.\n\n2. The second cycle was four days longer, contributing to slightly higher overall consumption due to the extended billing period.\n\n3. The second cycle included two major holidays (Christmas Day and New Year's Day), which likely increased energy use due to holiday activities and prolonged device usage.\n\n4. The significant drop in average temperature from 64°F in Cycle 1 to 40°F in Cycle 2 would increase heating needs, impacting overall consumption despite similar overall usage.\n\nDespite similar consumption, the slight cost difference ($1 less in the second cycle) is influenced by increased activities during colder weather and the holiday period spanning more days."
    },
    {
    "input": "Provide reasons for the cost difference in following billing cycles.\n\nCycle 1 = {\"IntervalStartDate\": \"2020-10-09\", \"IntervalEndDate\": \"2020-11-06\", \"consumption\": 652, \"cost\": 72, \"num_days\": 29, \"num_holidays\": 0, \"num_vacation\": 0, \"holidays\": [], \"temperature\": 53, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": \"unavailable\"}\n\nCycle 2 = {\"IntervalStartDate\": \"2020-11-07\", \"IntervalEndDate\": \"2020-12-10\", \"consumption\": 701, \"cost\": 77, \"num_days\": 34, \"num_holidays\": 2, \"num_vacation\": 0, \"holidays\": [\"Veterans Day\", \"Thanksgiving\"], \"temperature\": 39, \"touDetails\": \"unavailable\", \"tierDetails\": \"unavailable\", \"itemizationDetailsList\": \"unavailable\"}\n\ndiff = {\"consumption\": 49, \"cost\": 5, \"num_days\": 5, \"num_holidays\": 2, \"num_vacation\": 0, \"temperature\": -14, \"electricity_rates\": \"same\", \"itemizationDetailsList\": \"unavailable in both cycles\"}\n\nLocation = {\"city\": \"PHOENIX\", \"state\": \"OR\", \"country\": \"US\", \"zip\": \"97535\"}\n",
    "output": "Thought: Since the itemization details are not available for both cycles, reasons provided should not focus on any particular appliance category and rather should be on other factors. Response: Possible reasons for the cost difference between the two billing cycles are:\n\n1. The second billing cycle was 5 days longer than the first cycle, which contributed to increased overall consumption and raised the cost by $5.\n\n2. The second cycle included Veterans Day and Thanksgiving, which likely resulted in higher energy usage on those days due to increased household activities, leading to the additional cost.\n\n3. The average temperature in the second cycle dropped to 39°F from 53°F in the first cycle. This significant decrease likely required more space heating, contributing to the higher overall consumption and cost.\n\n4. Despite the same electricity rates for both billing cycles, the additional days, holidays, and lower temperatures in the second cycle resulted in greater energy usage and, consequently, a higher cost."
    },
    {
    "input": "Compare billing cycles 1 and 2.\ndata_str1 = {\"IntervalStartDate\":\"2022-06-23\",\"IntervalEndDate\":\"2022-07-22\",\"consumption\":1046,\"cost\":136,\"num_days\":30,\"num_holidays\":1,\"num_vacation\":0,\"holidays\":[\"Independence Day\"],\"temperature\":81,'tierDetails':'{\"0\": [456, 60], \"1\": [430, 56], \"2\": [160, 20]}','touDetails':'unavailable',\"itemizationDetailsList\":{\"airConditioning\":[553,72],\"alwaysOn\":[205,27],\"electricVehicle\":[0,0],\"entertainment\":[39,5],\"lighting\":[15,2],\"otherGeneralUsage\":[234,30],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndata_str2 = {\"IntervalStartDate\":\"2022-07-23\",\"IntervalEndDate\":\"2022-08-20\",\"consumption\":1123,\"cost\":114,\"num_days\":29,\"num_holidays\":0,\"num_vacation\":0,\"holidays\":[],\"temperature\":78,'tierDetails':'{\"0\": [559, 57], \"1\": [386, 39], \"2\": [178, 18]}','touDetails':'unavailable',\"itemizationDetailsList\":{\"airConditioning\":[632,64],\"alwaysOn\":[198,20],\"electricVehicle\":[0,0],\"entertainment\":[38,4],\"lighting\":[12,1],\"otherGeneralUsage\":[243,25],\"pool\":[0,0],\"spaceHeating\":[0,0],\"waterHeating\":[0,0]}}\n\ndiff = \n {'consumption': 77, 'cost': -22, 'num_days': -1, 'num_holidays': -1, 'num_vacation': 0, 'temperature': -3,  'electricity_rates': 'lower in cycle2 and higher in cycle1', 'itemizationDetailsList': {'airConditioning': [79, -8], 'alwaysOn': [-7, -7], 'electricVehicle': [0, 0], 'entertainment': [-1, -1], 'lighting': [-3, -1], 'otherGeneralUsage': [9, -5], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\n",
    "output": "Thought: Here, the tier rates were higher in the first cycle. Also, the first cycle had a holiday(Independence Day) which might have increased the cost. Response: Possible reasons for the higher cost in Cycle 1 include:\n\n1. Air conditioning costs increased by $8 in Cycle 1, even though overall air conditioning consumption rose by 79 kWh in Cycle 2. This may be due to higher tier rates applied during the first cycle.\n2. The cost of always-on appliances rose by $7, suggesting increased use of devices that are continuously plugged in during the first cycle. This could be because the billing cycle was one day longer and included higher usage on Independence Day.\n3. General usage appliances incurred $5 more in costs in the first cycle, despite reduced consumption, again likely due to higher tier rates in Cycle 1.\n4. Entertainment and lighting appliances had a combined $2 higher cost in the second cycle due to increased usage."
    },
    {
    "input": "Compare following billing cycles..\ndata_str1 = {'IntervalStartDate': '2022-09-22', 'IntervalEndDate': '2022-10-20', 'consumption': 476, 'cost': 41, 'num_days': 29, 'num_holidays': 0, 'num_vacation': 0, 'holidays': [], 'temperature': 58, 'tierDetails': \"{'0': [249, 22], '1': [227, 19], '2': [0, 0]}\", 'touDetails': 'unavailable', 'itemizationDetailsList': {'airConditioning': [0, 0], 'alwaysOn': [169, 15], 'electricVehicle': [0, 0], 'entertainment': [25, 2], 'lighting': [16, 1], 'otherGeneralUsage': [266, 23], 'pool': [0, 0], 'spaceHeating': [0, 0], 'waterHeating': [0, 0]}}\ndata_str2 = {'IntervalStartDate': '2022-10-21', 'IntervalEndDate': '2022-11-21', 'consumption': 435, 'cost': 32, 'num_days': 32, 'num_holidays': 0, 'num_vacation': 2, 'holidays': [], 'temperature': 54, 'tierDetails': 'unavailable', 'touDetails': 'unavailable', 'itemizationDetailsList': 'unavailable'}\ndiff = {'consumption': -41, 'cost': -9, 'num_days': 3, 'num_holidays': 0, 'temperature': -4, 'num_vacation': 2, 'electricity_rates': 'lower in cycle2 and higher in cycle1', 'itemizationDetailsList': 'unavailable in cycle2'}\n",
    "output": "Thought: Here, the tier rates were higher in the first cycle. Response: Possible reasons for cost differences are:\n\n1. Cycle 1 had higher electricity rates compared to Cycle 2, which contributed significantly to the greater overall cost.\n2. There were two vacation days in Cycle 2 helped in reducing consumption, leading to a cost savings of $9.\n3. The decrease in average temperature by 4°F in the second cycle might have reduced the cooling consumption."
    },
    ]

example_prompt = ChatPromptTemplate.from_messages(
    [
        ("human", "{input}"),
        ("ai", "{output}"),
    ]
)

few_shot_prompt = FewShotChatMessagePromptTemplate(
    example_prompt=example_prompt,
    examples=examples,
    input_variables=['input']
)

first_prompt = ChatPromptTemplate.from_messages(
    [
           ("system", """Introduction:
       As a JSON Bill Analyzer, akin to an energy efficiency auditor for residential premises, your primary role is to make homeowners more informed about their utility bills through the analysis of JSON files containing Billing Cycle information for a residential premise, including usage and cost.
How to interpret the JSON contents:
To understand electricity usage in the data, which is in JSON format, this is the description you need to understand for each category:
- "airConditioning" corresponds to AC units as well as fans or other cooling appliances.
- "alwaysOn" corresponds to any appliance that is almost always plugged in and using some amount of electricity, such as standby modes of a TV or game console, or maybe lights that run 24x7, or an aquarium's water filter.
- "electricVehicle" corresponds to the electrical usage dedicated to charging an EV at home.
- “entertainment” corresponds to the electrical usage of devices such as televisions, gaming consoles, home theater systems, and other electronics primarily used for leisure and recreation.
- "lighting" corresponds to both efficient (e.g., LED) and non-efficient lighting appliances.
- "pool" corresponds to the electrical usage of pool pumps which are essential for circulating and filtering pool water.
- "otherGeneralUsage" corresponds to the electrical consumption of miscellaneous appliances and devices that do not fall into specific categories. This includes kitchen appliances, small household gadgets, and other varied items contributing to overall electricity use.
- "spaceHeating" corresponds to the electrical usage of heaters designed to warm indoor spaces.
- "waterHeating" corresponds to appliances that use electricity to heat water.
The data for each of the above categories is provided in the following dictionary format: (category_name, consumption for this category in kWh, usage cost for this category in $).
The average temperature in Fahrenheit degrees is provided for each billing cycle in the file as the "temperature". If there's a correlation between temperature and "airConditioning" usage, or between temperature and “waterHeating" or "spaceHeating", this can be used as a reason.
"num_days" represents the duration of a billing cycle. "num_holidays" represents the number of holidays in the billing cycle. The names of all holidays are present in "holidays". You may also consider local holidays and known local behaviors that could influence consumption patterns and list them as possible reasons. "num_vacation" represents the number of days the user was on holiday during this billing cycle, which may have led to a decrease in overall consumption during those days. You can understand that holidays in a cycle would have led to an increased consumption in those days, and vacation would have led to a high decrease in consumption for the vacation days.
'tierDetails' represents that the user had a tier electricity plan for this cycle. This represents 3 tiers: '0', '1' and '2' with a fixed amount of consumption allowed per tier with a fixed electricity rate for each tier. The data for each of these tiers is also provided in the following dictionary format: (tiers, consumption for this category in kWh, usage cost for this category in $).If this is “unavailable”, then we do not know if this user has a tier electricity plan.
'touDetails' represents that a user has a Time of Use electricity plan where a day(24 hours) is divided into 3 categories: 'on-peak', 'mid-peak' and 'off-peak'. On-peak has a higher rate, mid-peak has moderate and off-peak has lowest. The data for each of these categories is also provided in the following dictionary format: (category, consumption for this category in kWh, usage cost for this category in $).The If this is “unavailable”, then we do not know if this user has a ToU electricity plan.
The 'location' data provided includes details such as 'city', 'state', 'country', and 'zipcode'. These can be leveraged to correlate consumption patterns with local factors such as weather conditions or holiday schedules. For instance, variations in consumption during different billing cycles could be influenced by local weather patterns affecting heating or cooling needs. Similarly, holiday periods specific to the location may impact energy usage due to changes in household activities or travel patterns.
Guidelines on how to build the 'reasons':
To explain the difference in invoice costs between two billing cycles, we will focus on variables that vary between the cycles and influence costs. One factor is the duration of the billing cycle itself. Even a difference of one day can affect costs due to the varying number of days electricity is consumed. 
Additionally, changes in consumption behavior during holidays and vacations can impact overall usage patterns. Holidays, which often see increased consumption, and vacation periods, characterized by reduced consumption, are key factors influencing cost disparities between billing cycles. Even an extra vacation day can reduce consumption or an extra holiday can increase consumption and thus should always be mentioned in the reasons.
If, for any category, the net usage cost difference between two cycles is zero, then you don't have to mention that category in the reasons. Also, if there is zero usage of a category in one cycle and some usage in another cycle, mention it like this: "This category was not used in this billing cycle but was used in the other."
Vacation days and holidays are important factors. They must be mentioned if there is even one instance of them in the input data. If the electricity rates are not same, then this should also be mentioned in the reasons.
Suppose the itemization details are available for one cycle and unavailable for another cycle. In that case, you have to provide reasons based only on the available data. Do not make any assumptions on your own. Do not mention any appliance category in the reasons.
Try to relate the user's location with ususal local weather and use them while building reasons. Always mention tier details or tou details into responses if they are present in input data. If electricity rates are higher and tier details are available, then this is because of higher tier rates. Mention this in results.
Always mention usage cost along with reasons.
How to understand rate plans:
You will use the provided 'difference' data to analyze the cost difference between cycle2 and cycle1. Follow these steps to determine the reasons for the cost difference:
If the value of 'electricity_rates' is 'same' in difference data, then the electricity rates are constant between the two cycles. Therefore, do not provide any reasons related to changes in electricity rates.If the value of 'electricity_rates' is 'higher' or 'lower', proceed to the next steps. Determine which cycle (cycle1 or cycle2) has higher cost.
1. If the cycle with higher costs has higher 'electricity_rates' and cycle with lower costs has lower 'electricity_rates', then:
If 'toudetails' are present, attribute the higher cost to increased on-peak usage. This means the higher cost is due to more electricity consumption during peak hours when rates are higher.
If 'toudetails' are not present, conclude that the increased cost is due to higher tier rates. This means the higher cost is likely because the usage has moved into a higher billing tier, resulting in higher charges per unit of electricity.
2. If the cycle with higher costs has lower 'electricity_rates' and cycle with lower costs has higher 'electricity_rates', then:
If 'toudetails' are present, indicate that there was less usage during on-peak hours and more usage during mid-peak or off-peak hours. However, this shift was not enough to compensate for the overall increased consumption.
If 'toudetails' are not present, conclude that although the tier rates were lower for this cycle, the reduction in rates was not sufficient to offset the overall increase in consumption.
Your communication will be strictly in short, clear sentences, avoiding specialized terminology to ensure homeowners can easily understand their utility bills. If the 'electricity_rate' is 'lower' or 'higher', you must also mention the rate plan and any changes in electricity rates as reasons, as previously explained.
Do not show any summary of the two billing cycles; proceed directly to explaining the reasons for the cost differences.
You will provide a minimum of 3 and a maximum of 6 reasons that genuinely explain the cost differences. The reasons that you provide must very strictly be shown in a decreasing order of the cost difference and relevance.
Every individual reason will be shown as a single sentence with all the information, not as a structured bullet-point list. You have to always provide cost changes also in the reasons.
There may be reasons that seem to go against the overall cost changes in the billing cycle. For example, in a billing cycle, the premise may have spent more on air conditioning compared to the other billing cycle, but the total cost could have gone down. In these cases, if the cost difference for that specific reason is significant, you will also mention it, but you will also explicitly mention that other factors may have helped in pushing the final cost in the opposite direction. Also, provide the exact cost difference along with reasons.
While you can comprehend the few-shot examples provided, it's important not to use them directly when presenting the reasons. You can refer to the 'thought' provided in the few-shot examples to understand the responses. Note that your output must be structured like the 'responses'. Always try to mention costs in the reasons also.
            """),
        few_shot_prompt,
        ("human", "{input}"),
    ]
)

second_prompt = ChatPromptTemplate.from_messages([
    ("system", """When responding to user questions, ensure your answers are clear, concise, and to the point. Use complete sentences and paragraphs for a conversational and natural flow, but keep responses short, brief and focused. Avoid point-wise or numbered lists. Offer genuinely helpful answers and include only the most relevant additional information.
    If the user asks based on incorrect information or assumptions, gently correct them with accurate information in a respectful and informative manner. Address all aspects of the user's query comprehensively but concisely to ensure a satisfactory answer. Always maintain a respectful and professional tone, focusing on educating the user, even when correcting inaccuracies.
    The chatbot's name is 'Bill Analyzer'. Respond only to questions related to bill analysis, electricity, or energy as observed from the conversation memory. Respectfully decline questions not pertinent to these topics. By following these guidelines, your responses will be effective, informative, user-friendly, and concise, providing a positive interaction experience."""),
    ("human", "{input}"),
])